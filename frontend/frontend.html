<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>frontend</title>
</head>
<body style="opacity:1">

    <div>
        <div>hello</div>
        <div>hello</div>
        <div>hello</div>
        <div>hello</div>
        <div>hello</div>
    </div>

    <script>

        // VIEW TYPE
        const view = {
            x0: 0, // position
            x1: 1, // dimension
            x2: 2, // rotation
            y0: 3,
            y1: 4,
            y2: 5,
            z0: 6,
            z1: 7,
            z2: 8
        }






        function update_body(b) {

            let time = performance.now();
            b.delta = time - b.time;
            b.time = time;

            width = document.documentElement.clientWidth + "";
            height = document.documentElement.clientHeight + "";

            // RESIZE EVENT
            if (b.object.style.width !== width) { b.object.style.width = width + "px"; }
            if (b.object.style.height !== height) { b.object.style.height = height + "px"; }
        }

        // @DONE
        function init_DOM(e, result) {
            let i = 0;
            while (i < e.length) {
              
                result.object.push(e[i]);

                if (e[i].children.length > 0) {
                    DOM_elements(e[i].children, result);
                }
                i += 1;
            }
            return 0;
        }


        /*
         * DOM_elements(body_children, result);
            result.object.pop();
            result.object[i].style.position = "absolute";
            result.object[i].style.margin = "0px";
            result.object[i].style.padding = "0px";
            result.object[i].style.border = "solid";
            result.object[i].style.left = "0px";
            result.object[i].style.top = "0px";
            result.object[i].style.width = "0px";
            result.object[i].style.height = "0px";
            result.object[i].style.zIndex = "0";
            result.object[i].style.overflow = "hidden";
        */


        // @NOT
        function init_views(size, result) {

            let view = {
                e: [], // event
                s: [], // state current frame
                p: [], // state previous frame

                // ANIMATION
                ar: [], // RUNNING
                ap: [], // PROGRESS
                at: [], // TIMER
                as: [], // SAMPLE
            }

            // STATE
            view.s.push(new Float32Array(size)); // x0
            view.s.push(new Float32Array(size)); // x1
            view.s.push(new Float32Array(size)); // x2
            view.s.push(new Float32Array(size)); // y0
            view.s.push(new Float32Array(size)); // y1
            view.s.push(new Float32Array(size)); // y2
            view.s.push(new Float32Array(size)); // z0
            view.s.push(new Float32Array(size)); // z1
            view.s.push(new Float32Array(size)); // z2

            // PREVIOUS
            view.p.push(new Float32Array(size)); // x0
            view.p.push(new Float32Array(size)); // x1
            view.p.push(new Float32Array(size)); // x2
            view.p.push(new Float32Array(size)); // y0
            view.p.push(new Float32Array(size)); // y1
            view.p.push(new Float32Array(size)); // y2
            view.p.push(new Float32Array(size)); // z0
            view.p.push(new Float32Array(size)); // z1
            view.p.push(new Float32Array(size)); // z2
            
            let i = 0;
            while (i < size) {

                // ANIMATION
                type.ar.push(new Int8Array(type.s.length));
                type.ap.push(new Float32Array(type.s.length));
                type.at.push(new Float64Array(type.s.length));
                type.as.push(new Int32Array(type.s.length));
                i += 1;
            }

            Object.assign(result, type);

        }


        init_elements(body.object.children, elements);

        console.log(elements);

        function update_dom(dom, views) {

            let i = 0;
            let len = e.object.length;

            // @ADD simple diffing algorithm later

            while (i < len) { e.object[i].style.width = (e.property[x1][i] - e.property[x0][i]) + "px"; i += 1; } i = 0;
            while (i < len) { e.object[i].style.height = (e.property[y1][i]- e.property[y0][i]) + "px"; i += 1; } i = 0;
            while (i < len) { e.object[i].style.transform = "translate(" + e.property[x0][i] + "px, " + e.property[y0][i] + "px) " + "rotate(" + e.property[z2][i] + "deg)"; i += 1; } i = 0;

            // clear dom events

        }



       

        function update_elements(e, b) {

            e.property[x1][0] = document.documentElement.clientWidth;
            e.property[y1][0] = document.documentElement.clientHeight;

            update_systems(e, b);
        }

        let views = []; //??? store persistent layout data





        function main() {

            update_layouts(layouts, elements);
            update_body(body);
            update_elements(elements, body);
            render(elements);
            window.requestAnimationFrame(main);
        }

        main();
    
    </script>
</body>
</html>